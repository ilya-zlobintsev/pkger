[info]
name = "test"
description = "pkger"
arch = "x86_64"
license = "MIT"
version = "0.0.5"
revision = "0"
source = ""
git = "https://github.com/wojciechkepka/pkger.git"
depends = ["libssl-dev"]
depends_rh = ["openssl-devel"]
exclude = ["share", "info"]
provides = ["pkger"]
images = [
	"debian10",
	"centos8",
]
[env]
ENV_VAR_TEST = "test.com:1010"

[build]
steps = [
	"mkdir -p /opt/pkger",
	# test if env variables from recipe work correctly
	"bash -c \"if [[ $ENV_VAR_TEST == \"test.com:1010\" ]]; then exit 0; else echo 'Environment variable ENV_VAR_TEST is not set properly'; exit 1; fi\"",

	# test if pkger env variables work correctly
	"echo $PKGER_OS",
	"bash -c \"if [[ $PKGER_OS =~ debian|centos ]]; then exit 0; else echo 'Environment variable PKGER_OS is not set properly'; exit 1; fi\"",
	"echo $PKGER_OS_VER",
	"bash -c \"if [[ $PKGER_OS_VER =~ 10|8 ]]; then exit 0; else echo 'Environment variable PKGER_VER is not set properly'; exit 1; fi\"",
	"echo $PKGER_BLD_DIR",
	"bash -c \"if [[ $PKGER_BLD_DIR =~ /tmp/test-[0-9]*/ ]]; then exit 0; else echo 'Environment variable PKGER_BLD_DIR is not set properly'; exit 1; fi\"",
]

[install]
steps = [
	"touch /opt/pkger/test_file"
]

[finish]
files = "/opt/pkger"
install_dir = "/tmp"
